<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberBackup Pro - v3.0 (API Driven)</title>
    
    <!-- Sentry JavaScript SDK for error tracking -->
    <script src="https://js.sentry.io/7.96.0/bundle.tracing.min.js" 
            integrity="sha384-6dGzKI0R4jYF3KXfOmzwK4k8pBJWOHggNhm6+ZtSL5w4j2V2TGe8A3E1J8EZzH8+" 
            crossorigin="anonymous"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Share+Tech+Mono:wght@400&display=swap" rel="stylesheet">

    <!-- CSS Files -->
    <link rel="stylesheet" href="styles/theme.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/layout.css">
    <link rel="stylesheet" href="styles/animations.css">
    <!-- Favicons: loaded from repo folder 'favicon_stuff' -->
    <!-- Adjust paths if you later move the favicon files to a different location or static server root -->
    <link rel="shortcut icon" href="../../favicon_stuff/favicon.ico" type="image/x-icon">
    <!-- SVG favicon (scales nicely on modern browsers) -->
    <link rel="icon" href="../../favicon_stuff/favicon.svg" type="image/svg+xml">
    <link rel="icon" type="image/png" sizes="32x32" href="../../favicon_stuff/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../favicon_stuff/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../../favicon_stuff/apple-icon-180x180.png">
    <link rel="apple-touch-icon" sizes="152x152" href="../../favicon_stuff/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="120x120" href="../../favicon_stuff/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="../../favicon_stuff/apple-icon-76x76.png">
    <link rel="icon" type="image/png" sizes="192x192" href="../../favicon_stuff/android-icon-192x192.png">
    <link rel="manifest" href="../../favicon_stuff/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="../../favicon_stuff/ms-icon-144x144.png">
    <!-- Cross-browser theme integration via CSS custom properties -->
    <style>
        /* Theme color integration for all browsers including Opera */
        :root {
            --browser-chrome-color: #000000;
        }
        
        /* Apply theme color to browser chrome where supported */
        html {
            background-color: var(--browser-chrome-color);
        }
        
        /* Opera-specific viewport styling */
        @supports (-webkit-appearance: none) and (not (-webkit-text-stroke: initial)) {
            html {
                background: linear-gradient(135deg, var(--bg-black) 0%, var(--bg-dark) 100%);
            }
        }
        
        /* Integration with existing CyberBackup theme variables */
        [data-theme="cyberpunk"] {
            --browser-chrome-color: var(--bg-black, #000000);
        }
        
        [data-theme="matrix"] {
            --browser-chrome-color: #001100;
        }
        
        [data-theme="dark"] {
            --browser-chrome-color: #111111;
        }
    </style>
</head>
<body>
    <div class="cyber-grid"></div>
    <div class="particle-container" id="particleContainer"></div>
    <div class="toast-container" id="toastContainer" role="status" aria-live="polite"></div>
    <div aria-live="polite" aria-atomic="true" class="sr-only" id="announcements"></div>
    
    <div class="container">
        <!-- Header -->
        <header class="header" role="banner">
            <div class="logo">
                <div class="logo-icon neon-text pink" tabindex="0" role="button" aria-label="CyberBackup Logo">‚ö°</div>
                <div class="logo-text">
                    <h1 class="neon-text pink">CYBERBACKUP PRO</h1>
                    <div class="subtitle">v3.0 (API Driven)</div>
                </div>
            </div>
            <div class="connection-status">
                <div class="status-led" id="connectionLed" aria-label="Connection status"></div>
                <span id="connectionText" class="connection-text-bold">OFFLINE</span>
                <div class="connection-health" id="connectionHealth">
                    <span id="healthIndicator">üì∂</span>
                    <span id="pingDisplay">-- ms</span>
                </div>
            </div>
        </header>

        <!-- Configuration Panel -->
        <aside class="config-panel glass-card" role="region" aria-label="Configuration">
            <div class="panel-header">
                <h2 class="panel-title">System Configuration</h2>
            </div>
            
            <div class="config-section">                <label class="config-label" for="serverInput">Server Address</label>
                <div class="copy-container">
                    <input type="text" class="config-input copy-content" id="serverInput" 
                           placeholder="127.0.0.1:1256" value="127.0.0.1:1256" aria-describedby="serverHelp">
                    <button type="button" class="copy-btn" id="copyServerAddress" title="Copy Server Address" aria-label="Copy Server Address">üìã</button>
                </div>
                <div id="serverHelp" class="sr-only">Enter server IP address and port</div>
            </div>
            
            <div class="config-section">
                <label class="config-label" for="usernameInput">Username</label>
                <input type="text" class="config-input" id="usernameInput"
                       placeholder="Enter your username" value="" maxlength="100" aria-describedby="usernameHelp">
                <div id="usernameHelp" class="sr-only">Username for authentication (max 100 characters)</div>
            </div>
            
            <div class="config-section">
                <label class="config-label">Target File</label>
                <div class="file-selection-container file-selection-container-positioned">
                    <div class="file-drop-zone" id="fileDropZone">
                        <input type="file" class="file-input" id="fileInput" 
                               aria-describedby="fileHelp" accept="*/*" 
                               title="Select a file to backup" 
                               aria-label="File selection for backup">
                        <div class="file-button">
                            üìÅ Select File to Backup
                            <span class="sr-only">or drag and drop a file here</span>
                        </div>
                    </div>
                    <button type="button" class="cyber-btn small secondary recent-files-btn" id="recentFilesBtn" 
                            title="Show recent files" aria-label="Show recent files">
                        üìÇ Recent Files
                    </button>
                </>
                <div id="fileHelp" class="sr-only">Select a file for backup or drag and drop</div>
                <div class="copy-container">
                    <div class="config-value copy-content" id="selectedFile">No file selected</div>
                    <button type="button" class="copy-btn copy-btn-hidden" id="copyFileInfo" title="Copy File Info" aria-label="Copy File Info">üìã</button>
                </div>
                <div id="filePreview" class="file-preview-container file-preview-layout"></div>
            </div>
            
            <div class="config-section">
                <label class="config-label">Client ID</label>
                <div class="copy-container">
                    <div class="config-value copy-content" id="clientId">Not connected</div>
                    <button type="button" class="copy-btn" id="copyClientId" title="Copy Client ID" aria-label="Copy Client ID">üìã</button>
                </div>
            </div>

            <div class="btn-group">
                <button type="button" class="cyber-btn success" data-action="save-config">üíæ Save Config</button>
            </div>

            <div class="panel-header panel-header-spaced">
                <h2 class="panel-title">Theme Selection</h2>
            </div>
            
            <div class="theme-selector">
                <button type="button" class="theme-btn cyberpunk active" 
                        aria-label="Cyberpunk theme" title="Cyberpunk Theme"></button>
                <button type="button" class="theme-btn dark" 
                        aria-label="Dark theme" title="Dark Theme"></button>
                <button type="button" class="theme-btn matrix" 
                        aria-label="Matrix theme" title="Matrix Theme"></button>
            </div>
        </aside>

        <!-- Main Panel -->
        <main class="main-panel glass-card" role="main">
            <div class="phase-display" id="currentPhase">
                <span class="neon-text purple">SYSTEM READY</span>
            </div>
            
            <div class="progress-container">
                <svg class="progress-ring" viewBox="0 0 300 300" role="img" aria-label="Transfer progress">
                    <defs>
                        <!-- Enhanced gradients for multi-ring system -->
                        <linearGradient id="progressGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" class="gradient-stop-blue" />
                            <stop offset="33%" class="gradient-stop-purple" />
                            <stop offset="66%" class="gradient-stop-pink" />
                            <stop offset="100%" class="gradient-stop-green" />
                        </linearGradient>
                        
                        <!-- Data channel gradient for outer ring -->
                        <linearGradient id="dataChannelGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" class="gradient-stop-data-channel-start" />
                            <stop offset="50%" class="gradient-stop-data-channel-middle" />
                            <stop offset="100%" class="gradient-stop-data-channel-end" />
                        </linearGradient>
                        
                        <!-- Phase indicator gradient -->
                        <linearGradient id="phaseGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" class="gradient-stop-phase-start" />
                            <stop offset="100%" class="gradient-stop-phase-end" />
                        </linearGradient>
                        
                        <!-- Particle glow filter -->
                        <filter id="particleGlow">
                            <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
                            <feMerge> 
                                <feMergeNode in="coloredBlur"/>
                                <feMergeNode in="SourceGraphic"/>
                            </feMerge>
                        </filter>
                    </defs>
                    
                    <!-- Outer Ring: Data Channel (Static, Rotating) -->
                    <circle class="data-channel-ring" cx="150" cy="150" r="145" 
                            fill="none" stroke="url(#dataChannelGradient)" stroke-width="2" 
                            stroke-dasharray="8,4" id="dataChannelRing"></circle>
                    
                    <!-- Background Ring -->
                    <circle class="progress-bg" cx="150" cy="150" r="130" 
                            fill="none" stroke="var(--bg-light)" stroke-width="16"></circle>
                    
                    <!-- Middle Ring: Phase Indicator Arc -->
                    <path class="phase-indicator-arc" id="phaseIndicatorArc" 
                          fill="none" stroke="url(#phaseGradient)" stroke-width="6" 
                          stroke-linecap="round"></path>
                    
                    <!-- Inner Ring: Progress Fill (Existing) -->
                    <circle class="progress-fill" cx="150" cy="150" r="130" id="progressCircle"></circle>
                    
                    <!-- Particle Stream Container -->
                    <g class="particle-stream" id="particleStream">
                        <!-- Particles will be dynamically generated here -->
                    </g>
                </svg>
                <div class="progress-text">
                    <div class="progress-percentage neon-text" id="progressPercentage">0%</div>
                    <div class="progress-label" id="progressStatus">READY</div>
                </div>
            </div>            <div class="control-panel">
                <button type="button" class="cyber-btn primary large control-btn" id="primaryAction">
                    <span class="btn-icon">üöÄ</span>
                    <span class="btn-text">CONNECT</span>
                </button>
                <button type="button" class="cyber-btn secondary large control-btn" id="pauseBtn" disabled>
                    <span class="btn-icon">‚è∏Ô∏è</span>
                    <span class="btn-text">PAUSE</span>
                </button>
                <button type="button" class="cyber-btn danger large control-btn" id="stopBtn" disabled>
                    <span class="btn-icon">üõë</span>
                    <span class="btn-text">STOP</span>
                </button>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="speedStat">0 B/s</div>
                    <div class="stat-label">Transfer Speed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="etaStat">--:--</div>
                    <div class="stat-label">ETA</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="transferredStat">0 B</div>
                    <div class="stat-label">Transferred</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="sizeStat">0 B</div>
                    <div class="stat-label">Total Size</div>
                </div>
            </div>
        </main>

        <!-- Status Panel -->
        <aside class="status-panel glass-card" role="region" aria-label="Operation log">
            <div class="panel-header">
                <h2 class="panel-title">Operation Log</h2>
                <div class="btn-group">
                    <button type="button" class="cyber-btn success small" data-action="export-log">üì• Export</button>
                    <button type="button" class="cyber-btn danger small" data-action="clear-log">üóëÔ∏è Clear</button>
                    <button type="button" class="cyber-btn primary small" id="autoScrollBtn">
                        üìú Auto-scroll: ON
                    </button>
                </div>
            </div>
            
            <div class="log-container" id="logContainer" role="log" aria-live="polite" aria-label="Activity log">
                <!-- Logs will be populated here -->
            </div>
        </aside>

        <!-- Debug Panel -->
        <div class="debug-panel glass-card" role="region" aria-label="Developer console">
            <div class="panel-header">
                <h2 class="panel-title">Developer Console</h2>
                <button type="button" class="cyber-btn primary small" id="debugToggle" 
                        aria-expanded="false">üîß Toggle Debug</button>
            </div>
            
            <div class="debug-content" id="debugContent">
                <div class="debug-grid">
                    <div class="debug-section">
                        <h3>üìä Last API Response</h3>
                        <div class="json-viewer" id="statusJsonViewer">Waiting for status data...</div>
                    </div>
                    <div class="debug-section">
                        <h3>üìà State Machine</h3>
                        <div class="json-viewer" id="progressJsonViewer">Waiting for state data...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Custom Confirmation Modal -->
    <div class="modal-overlay confirm-modal" id="confirmModal">
        <div class="modal">
            <h3 class="modal-title" id="confirmTitle">Confirm Action</h3>
            <p class="modal-message" id="confirmMessage">Are you sure?</p>
            <div class="modal-buttons">
                <button type="button" class="cyber-btn secondary" id="cancelModalBtn" data-action="cancel-modal">Cancel</button>
                <button type="button" class="cyber-btn danger" id="confirmOkBtn">Confirm</button>
            </div>
        </div>
    </div>
    
    <!-- Socket.IO Client Library for Real-Time Communication -->
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js" 
            integrity="sha384-2huaZvOR9iDzHqslqwpR87isEmrfxqyWOF7hr7BY6KG0+hVKLoEXMPUJw3ynWuhO" 
            crossorigin="anonymous"></script>
    
    <!-- JavaScript Files (as modules for dependency management) -->
    <script type="module" src="scripts/core/app.js"></script>

</body>
</html>